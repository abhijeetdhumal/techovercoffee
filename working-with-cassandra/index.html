<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style id="typography.js">html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{background-color:transparent;-webkit-text-decoration-skip:objects}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{font:100%/1.75 'Merriweather','Georgia',serif;box-sizing:border-box;overflow-y:scroll;}*{box-sizing:inherit;}*:before{box-sizing:inherit;}*:after{box-sizing:inherit;}body{color:hsla(0,0%,0%,0.9);font-family:'Merriweather','Georgia',serif;font-weight:400;word-wrap:break-word;font-kerning:normal;-moz-font-feature-settings:"kern", "liga", "clig", "calt";-ms-font-feature-settings:"kern", "liga", "clig", "calt";-webkit-font-feature-settings:"kern", "liga", "clig", "calt";font-feature-settings:"kern", "liga", "clig", "calt";}img{max-width:100%;margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}h1{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:Montserrat,sans-serif;font-weight:900;text-rendering:optimizeLegibility;font-size:2.5rem;line-height:1.1;}h2{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:'Merriweather','Georgia',serif;font-weight:900;text-rendering:optimizeLegibility;font-size:1.73286rem;line-height:1.1;}h3{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:'Merriweather','Georgia',serif;font-weight:900;text-rendering:optimizeLegibility;font-size:1.4427rem;line-height:1.1;}h4{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:'Merriweather','Georgia',serif;font-weight:900;text-rendering:optimizeLegibility;font-size:1rem;line-height:1.1;letter-spacing:0.140625em;text-transform:uppercase;}h5{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:'Merriweather','Georgia',serif;font-weight:900;text-rendering:optimizeLegibility;font-size:0.83255rem;line-height:1.1;}h6{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:'Merriweather','Georgia',serif;font-weight:900;text-rendering:optimizeLegibility;font-size:0.75966rem;line-height:1.1;font-style:italic;}hgroup{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}ul{margin-left:1.75rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;list-style-position:outside;list-style-image:none;list-style:disc;}ol{margin-left:1.75rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;list-style-position:outside;list-style-image:none;}dl{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}dd{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}p{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}figure{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}pre{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;font-size:0.85rem;line-height:1.75rem;}table{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;font-size:1rem;line-height:1.75rem;border-collapse:collapse;width:100%;}fieldset{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}blockquote{margin-left:-1.75rem;margin-right:1.75rem;margin-top:0;padding-bottom:0;padding-left:1.42188rem;padding-right:0;padding-top:0;margin-bottom:1.75rem;font-size:1.20112rem;line-height:1.75rem;color:hsla(0,0%,0%,0.59);font-style:italic;border-left:0.32813rem solid hsla(0,0%,0%,0.9);}form{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}noscript{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}iframe{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}hr{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:calc(1.75rem - 1px);background:hsla(0,0%,0%,0.2);border:none;height:1px;}address{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}b{font-weight:700;}strong{font-weight:700;}dt{font-weight:700;}th{font-weight:700;}li{margin-bottom:calc(1.75rem / 2);}ol li{padding-left:0;}ul li{padding-left:0;}li > ol{margin-left:1.75rem;margin-bottom:calc(1.75rem / 2);margin-top:calc(1.75rem / 2);}li > ul{margin-left:1.75rem;margin-bottom:calc(1.75rem / 2);margin-top:calc(1.75rem / 2);}blockquote *:last-child{margin-bottom:0;}li *:last-child{margin-bottom:0;}p *:last-child{margin-bottom:0;}li > p{margin-bottom:calc(1.75rem / 2);}code{font-size:0.85rem;line-height:1.75rem;}kbd{font-size:0.85rem;line-height:1.75rem;}samp{font-size:0.85rem;line-height:1.75rem;}abbr{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}acronym{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}abbr[title]{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;text-decoration:none;}thead{text-align:left;}td,th{text-align:left;border-bottom:1px solid hsla(0,0%,0%,0.12);font-feature-settings:"tnum";-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";padding-left:1.16667rem;padding-right:1.16667rem;padding-top:0.875rem;padding-bottom:calc(0.875rem - 1px);}th:first-child,td:first-child{padding-left:0;}th:last-child,td:last-child{padding-right:0;}blockquote > :last-child{margin-bottom:0;}blockquote cite{font-size:1rem;line-height:1.75rem;color:hsla(0,0%,0%,0.9);font-weight:400;}blockquote cite:before{content:"— ";}ul,ol{margin-left:0;}@media only screen and (max-width:480px){ul,ol{margin-left:1.75rem;}blockquote{margin-left:-1.3125rem;margin-right:0;padding-left:0.98438rem;}}h1,h2,h3,h4,h5,h6{margin-top:3.5rem;}a{box-shadow:0 1px 0 0 currentColor;color:#007acc;text-decoration:none;}a:hover,a:active{box-shadow:none;}mark,ins{background:#007acc;color:white;padding:0.10938rem 0.21875rem;text-decoration:none;}a.gatsby-resp-image-link{box-shadow:none;}</style><style data-href="/styles.cb543765be1fef026fc6.css">@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:100;src:local("Montserrat Thin "),local("Montserrat-Thin"),url(/static/montserrat-latin-100-191cc9f50f3b76b9617cb383f19acb7d.woff2) format("woff2"),url(/static/montserrat-latin-100-370318464551d5f25b0f0a78f374faac.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:100;src:local("Montserrat Thin italic"),local("Montserrat-Thinitalic"),url(/static/montserrat-latin-100italic-bdeaeb79db315697bd173a55b097dc18.woff2) format("woff2"),url(/static/montserrat-latin-100italic-ecf7d49386e8f265878e735db34a7c4b.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:200;src:local("Montserrat Extra Light "),local("Montserrat-Extra Light"),url(/static/montserrat-latin-200-85d5ef9db7f2dc6979172a4a3b2c57cb.woff2) format("woff2"),url(/static/montserrat-latin-200-1fc98e126a3d152549240e6244d7e669.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:200;src:local("Montserrat Extra Light italic"),local("Montserrat-Extra Lightitalic"),url(/static/montserrat-latin-200italic-49095760a498d024fe1a85a078850df9.woff2) format("woff2"),url(/static/montserrat-latin-200italic-fe46cf8b9462c820457d3bf537e4057f.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:300;src:local("Montserrat Light "),local("Montserrat-Light"),url(/static/montserrat-latin-300-7c3daf12b706645b5d3710f863a4da04.woff2) format("woff2"),url(/static/montserrat-latin-300-8dc95fab9cf98d02ca8d76e97d3dff60.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:300;src:local("Montserrat Light italic"),local("Montserrat-Lightitalic"),url(/static/montserrat-latin-300italic-f20b178ca2024a5eac8e42e6649db86c.woff2) format("woff2"),url(/static/montserrat-latin-300italic-3fe16939288856e8e828fa2661bf2354.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:400;src:local("Montserrat Regular "),local("Montserrat-Regular"),url(/static/montserrat-latin-400-bc3aa95dca08f5fee5291e34959c27bc.woff2) format("woff2"),url(/static/montserrat-latin-400-8102c4838f9e3d08dad644290a9cb701.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:400;src:local("Montserrat Regular italic"),local("Montserrat-Regularitalic"),url(/static/montserrat-latin-400italic-5cad650422a7184467af5a4d17b264c4.woff2) format("woff2"),url(/static/montserrat-latin-400italic-d191f22af3bb50902b99ac577f81a322.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:500;src:local("Montserrat Medium "),local("Montserrat-Medium"),url(/static/montserrat-latin-500-92d16e458625f4d2c8940f6bdca0ff09.woff2) format("woff2"),url(/static/montserrat-latin-500-8b763220218ffc11c57c84ddb80e7b26.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:500;src:local("Montserrat Medium italic"),local("Montserrat-Mediumitalic"),url(/static/montserrat-latin-500italic-47bfcca6b69d6a9acca7a8bff17193e2.woff2) format("woff2"),url(/static/montserrat-latin-500italic-72c01f753c3940c0b9cb6bf2389caddf.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:600;src:local("Montserrat SemiBold "),local("Montserrat-SemiBold"),url(/static/montserrat-latin-600-6fb1b5623e528e27c18658fecf5ee0ee.woff2) format("woff2"),url(/static/montserrat-latin-600-7c839d15a6f54e7025ba8c0c4b333e8f.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:600;src:local("Montserrat SemiBold italic"),local("Montserrat-SemiBolditalic"),url(/static/montserrat-latin-600italic-60789af1c9338ed1a9546722ec54b4f7.woff2) format("woff2"),url(/static/montserrat-latin-600italic-f3d4de8d0afb19e777c79032ce828e3d.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:700;src:local("Montserrat Bold "),local("Montserrat-Bold"),url(/static/montserrat-latin-700-39d93cf678c740f9f6b2b1cfde34bee3.woff2) format("woff2"),url(/static/montserrat-latin-700-80f10bd382f0df1cd650fec59f3c9394.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:700;src:local("Montserrat Bold italic"),local("Montserrat-Bolditalic"),url(/static/montserrat-latin-700italic-ba136d97b14e82284dd595e257f11c47.woff2) format("woff2"),url(/static/montserrat-latin-700italic-8c98142b425630821139c24bd1698700.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:800;src:local("Montserrat ExtraBold "),local("Montserrat-ExtraBold"),url(/static/montserrat-latin-800-b7018be9ed6cd94da8b6675b3a468c3b.woff2) format("woff2"),url(/static/montserrat-latin-800-9a9befcf50d64f9d2d19d8b1d1984add.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:800;src:local("Montserrat ExtraBold italic"),local("Montserrat-ExtraBolditalic"),url(/static/montserrat-latin-800italic-540ffdd223d1a9ad3d4e678e1a23372e.woff2) format("woff2"),url(/static/montserrat-latin-800italic-897086f99f4e1f45e6b1e9368527d0bc.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:900;src:local("Montserrat Black "),local("Montserrat-Black"),url(/static/montserrat-latin-900-58cd789700850375b834e8b6776002eb.woff2) format("woff2"),url(/static/montserrat-latin-900-26d42c9428780e545a540bbb50c84bce.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:900;src:local("Montserrat Black italic"),local("Montserrat-Blackitalic"),url(/static/montserrat-latin-900italic-451157bc8861fe54f523b3669a3def71.woff2) format("woff2"),url(/static/montserrat-latin-900italic-a8ec4957e1c24f5793305763ad9845b3.woff) format("woff")}@font-face{font-family:Merriweather;font-style:normal;font-display:swap;font-weight:300;src:local("Merriweather Light "),local("Merriweather-Light"),url(/static/merriweather-latin-300-b1158cfcd4aacb9d8fb61625e37af46a.woff2) format("woff2"),url(/static/merriweather-latin-300-cc7de05e166e90320d7d896e0f72a19d.woff) format("woff")}@font-face{font-family:Merriweather;font-style:italic;font-display:swap;font-weight:300;src:local("Merriweather Light italic"),local("Merriweather-Lightitalic"),url(/static/merriweather-latin-300italic-8fe52a48089d6ebe46db0b8e7cc66263.woff2) format("woff2"),url(/static/merriweather-latin-300italic-e1331f5397c2a673f9d3765138debdb5.woff) format("woff")}@font-face{font-family:Merriweather;font-style:normal;font-display:swap;font-weight:400;src:local("Merriweather Regular "),local("Merriweather-Regular"),url(/static/merriweather-latin-400-8276fdb72ae8f4714d4e6eba704cc39f.woff2) format("woff2"),url(/static/merriweather-latin-400-69f09800f4f6479d06e44eba837df872.woff) format("woff")}@font-face{font-family:Merriweather;font-style:italic;font-display:swap;font-weight:400;src:local("Merriweather Regular italic"),local("Merriweather-Regularitalic"),url(/static/merriweather-latin-400italic-3a9be9ea9f7aa4af6de7307df21d9fc0.woff2) format("woff2"),url(/static/merriweather-latin-400italic-d76079ed7541a433a54f79316de086e9.woff) format("woff")}@font-face{font-family:Merriweather;font-style:normal;font-display:swap;font-weight:700;src:local("Merriweather Bold "),local("Merriweather-Bold"),url(/static/merriweather-latin-700-fa534be7ffa380e39a7f6e03bf9a5e03.woff2) format("woff2"),url(/static/merriweather-latin-700-ba56ea84b8084b7ff9677f50d3cd81bd.woff) format("woff")}@font-face{font-family:Merriweather;font-style:italic;font-display:swap;font-weight:700;src:local("Merriweather Bold italic"),local("Merriweather-Bolditalic"),url(/static/merriweather-latin-700italic-1ef5edaaa20ae53ea50399884c5e48c6.woff2) format("woff2"),url(/static/merriweather-latin-700italic-534bc9e7ce93c73d73426e46acd78092.woff) format("woff")}@font-face{font-family:Merriweather;font-style:normal;font-display:swap;font-weight:900;src:local("Merriweather Black "),local("Merriweather-Black"),url(/static/merriweather-latin-900-7528fb70e8a4a82c7305e72ff43ac25f.woff2) format("woff2"),url(/static/merriweather-latin-900-3799b6e2f5ed3fcccf9d7a708d7419fa.woff) format("woff")}@font-face{font-family:Merriweather;font-style:italic;font-display:swap;font-weight:900;src:local("Merriweather Black italic"),local("Merriweather-Blackitalic"),url(/static/merriweather-latin-900italic-e1b4d2aaa78e12ad84aaf8a56321e4c2.woff2) format("woff2"),url(/static/merriweather-latin-900italic-2ae22f731b3424e8dbb4b37f7ca6e708.woff) format("woff")}code[class*=language-],pre[class*=language-]{color:#657b83;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}code[class*=language-]::selection,code[class*=language-] ::selection,pre[class*=language-]::selection,pre[class*=language-] ::selection{background:#073642}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto;border-radius:.3em}:not(pre)>code[class*=language-],pre[class*=language-]{background-color:#fdf6e3}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#93a1a1}.token.punctuation{color:#586e75}.namespace{opacity:.7}.token.boolean,.token.constant,.token.deleted,.token.number,.token.property,.token.symbol,.token.tag{color:#268bd2}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string,.token.url{color:#2aa198}.token.entity{color:#657b83;background:#eee8d5}.token.atrule,.token.attr-value,.token.keyword{color:#859900}.token.class-name,.token.function{color:#b58900}.token.important,.token.regex,.token.variable{color:#cb4b16}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.tags{margin-bottom:10px}.tags .tag{background:#f8f8f8;box-shadow:none;padding:4px 7px;margin-right:10px}.gatsby-highlight[data-language]{position:relative}.gatsby-highlight[data-language] pre{background:#f4f4f9;padding-top:1.5em}.gatsby-highlight[data-language]:before{background:#d9d7e0;color:#444;border-radius:0 0 4px 4px;font-size:10px;line-height:1;padding:4px 7px;position:absolute;text-align:right;text-transform:uppercase;top:0;left:1em;content:attr(data-language)}.gatsby-highlight[data-language=javascript]:before{background:#f7df1e none repeat scroll 0 0}</style><meta name="generator" content="Gatsby 2.18.7"/><link rel="sitemap" type="application/xml" href="/sitemap.xml"/><style type="text/css">.gatsby-resp-image-image{width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;color:transparent;}</style><link rel="preconnect" href="https://www.google-analytics.com"/><link rel="dns-prefetch" href="https://www.google-analytics.com"/><script>
  
  
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'UA-176302969-1', 'auto', {});
      
      
      
      
      
      }</script><link rel="alternate" type="application/rss+xml" title="backtracking.dev RSS Feed" href="/rss.xml"/><title data-react-helmet="true">Working with cassandra at scale | Backtracking Dev</title><link data-react-helmet="true" rel="icon" type="image/png" sizes="24x24" href="/opensource_24.png"/><link data-react-helmet="true" rel="icon" type="image/png" sizes="32x32" href="/opensource_32.png"/><meta data-react-helmet="true" name="description" content="Summary of learnings while testing cassandra at scale"/><meta data-react-helmet="true" property="og:title" content="Working with cassandra at scale"/><meta data-react-helmet="true" property="og:description" content="Summary of learnings while testing cassandra at scale"/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" property="og:url" content="https://backtracking.dev/working-with-cassandra/"/><meta data-react-helmet="true" property="og:image" content="https://backtracking.dev/featured-images/cassandra.png"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:creator" content="@abhijeetdhumal"/><meta data-react-helmet="true" name="twitter:title" content="Working with cassandra at scale"/><meta data-react-helmet="true" name="twitter:description" content="Summary of learnings while testing cassandra at scale"/><meta data-react-helmet="true" name="twitter:image" content="https://backtracking.dev/featured-images/cassandra.png"/><link as="script" rel="preload" href="/webpack-runtime-2c7cf114e72f8be8c654.js"/><link as="script" rel="preload" href="/app-58c38faf7e2e99e839fb.js"/><link as="script" rel="preload" href="/styles-05ec49f1e97fde7879c1.js"/><link as="script" rel="preload" href="/commons-b9db83118e7f66f55c18.js"/><link as="script" rel="preload" href="/component---src-templates-blog-post-js-b10f2a3014285766b4ab.js"/><link as="fetch" rel="preload" href="/page-data/working-with-cassandra/page-data.json" crossorigin="anonymous"/></head><body><noscript id="gatsby-noscript">This app works best with JavaScript enabled.</noscript><div id="___gatsby"><div style="outline:none" tabindex="-1" role="group" id="gatsby-focus-wrapper"><div style="margin-left:auto;margin-right:auto;max-width:42rem;padding:2.625rem 1.3125rem"><header><h3 style="font-family:Montserrat, sans-serif;margin-top:0"><a style="box-shadow:none;text-decoration:none;color:inherit" href="/">Backtracking Dev</a></h3><script id="Cookiebot" src="https://consent.cookiebot.com/uc.js" data-cbid="ac9346d1-4404-418a-b759-8d4121912bbf" data-blockingmode="auto" type="text/javascript"></script></header><main><article><header><h1 style="margin-top:1.75rem;margin-bottom:0">Working with cassandra at scale</h1><p style="font-size:0.83255rem;line-height:1.75rem;display:block;margin-bottom:1.75rem">September 06, 2020</p></header><div class="tags"><a class="tag" href="/tags/cassandra">cassandra</a><a class="tag" href="/tags/performance">performance</a><a class="tag" href="/tags/nosql">nosql</a><a class="tag" href="/tags/kubernetes">kubernetes</a></div><div class=" gatsby-image-wrapper" style="position:relative;overflow:hidden;margin-bottom:20px"><div style="width:100%;padding-bottom:29.478260869565215%"></div><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAAsSAAALEgHS3X78AAAAsklEQVQY042OvwuCQBiG+6vb+h80aKumhixcCmyIhoIyD3/k3Wk0RFFTlskdkh7qFeIkGvWs7/e879d4f4NnD98/Xa5P78YY45xXTxq1YhAE0nrXGkybfVkcKYLYvnteXliuKMlF9gpD6B5626OwxF393FHUoTSu3ahZztKUEoKwM1ms5NncMow0Sf6VWRw7OdgydKBugKYBAAghP94uiKIIIQQhNE3Ttu2962KEKKVV+QNs9VDshbRuMwAAAABJRU5ErkJggg==" alt="" style="position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;object-position:center;opacity:1;transition-delay:500ms"/><noscript><picture><source srcset="/static/bd30e8ad5b7a65638af60a40cede3526/59beb/cassandra.png 200w,
/static/bd30e8ad5b7a65638af60a40cede3526/c0bbd/cassandra.png 400w,
/static/bd30e8ad5b7a65638af60a40cede3526/a54c6/cassandra.png 800w,
/static/bd30e8ad5b7a65638af60a40cede3526/9911c/cassandra.png 1200w,
/static/bd30e8ad5b7a65638af60a40cede3526/c8bd7/cassandra.png 1600w,
/static/bd30e8ad5b7a65638af60a40cede3526/37945/cassandra.png 2300w" sizes="(max-width: 800px) 100vw, 800px" /><img loading="lazy" sizes="(max-width: 800px) 100vw, 800px" srcset="/static/bd30e8ad5b7a65638af60a40cede3526/59beb/cassandra.png 200w,
/static/bd30e8ad5b7a65638af60a40cede3526/c0bbd/cassandra.png 400w,
/static/bd30e8ad5b7a65638af60a40cede3526/a54c6/cassandra.png 800w,
/static/bd30e8ad5b7a65638af60a40cede3526/9911c/cassandra.png 1200w,
/static/bd30e8ad5b7a65638af60a40cede3526/c8bd7/cassandra.png 1600w,
/static/bd30e8ad5b7a65638af60a40cede3526/37945/cassandra.png 2300w" src="/static/bd30e8ad5b7a65638af60a40cede3526/a54c6/cassandra.png" alt="" style="position:absolute;top:0;left:0;opacity:1;width:100%;height:100%;object-fit:cover;object-position:center"/></picture></noscript></div><section><p>While working with cassandra we experimented a lot to analyse the performance of the cassandra on kubernetes cluster. </p>
<p>Here are the some learnings from the extensive testing.</p>
<h3>Write (Bulk)</h3>
<ul>
<li>
<p>[k8s] Concurrency: 200; Num CPU’s Client: 2; # Records: 116547279</p>
<ul>
<li>Time taken to Insert in C* 2h54m26.765794644s</li>
<li>Total Record Counts: 173801976</li>
<li>Error Counts: 0</li>
</ul>
</li>
<li>
<p>[k8s] Concurrency: 1000; Num CPU’s Client: 16; # Records: 116547186</p>
<ul>
<li>Time taken to Insert in C* 1h56m43.787323892s</li>
<li>Total Record Counts: 173801976</li>
<li>Error Counts: 11449</li>
</ul>
</li>
<li>
<p>Using spark to import data directly from s3</p>
<ul>
<li>Number of nodes in cassandra cluster: 8 x i3.xlarge</li>
<li>Replication factor: 2</li>
<li>Number of nodes in emr cluster: 10 x m3.xlarge</li>
<li>Number of records: 4.820.489.450 (all snippets)</li>
<li>Time taken: 24 hours</li>
<li>Number of writes per core per second: 1743</li>
</ul>
</li>
</ul>
<p><strong>Inference</strong>: Client scales linearly with the number of available cores. We need to make sure that we are not keeping the concurrency too high. Also in the second case the number of available cpu’s with the client is 16 this is greater than the number of cpus with all cassandra nodes (4 x 3 = 12)</p>
<h3>Read (Bulk)</h3>
<ul>
<li>
<p><strong>Test setup 1</strong></p>
<ul>
<li>Number of nodes in cassandra cluster: 6 x i3.xlarge</li>
<li>Number of client nodes: 2 x m3.xlarge</li>
<li>Number of queries: ~21M</li>
<li>Time taken: ~7000 sec</li>
<li>Number of reads per cassandra core per second: 125</li>
<li>Number of reads per client core per second: 375</li>
</ul>
</li>
</ul>
<h3>Test: Does commit log placement affect write performance?</h3>
<ul>
<li>
<p><strong>Test setup: cassandra cluster running on 3 x i3.xlarge</strong></p>
<ul>
<li>Number of client writer nodes: 10 x m3.xlarge</li>
<li>Number of rows to insert: ~46M</li>
<li>
<p>Commit log placements tested:</p>
<ul>
<li>Ephemeral drive, same as where data is stored</li>
<li>Root SSD drive</li>
<li>Separate EBS (HDD Standard)</li>
<li>Separate EBS (SSD GP2)
Time taken in each test: 12 minutes</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3>Failure Testing</h3>
<h3>Case 1: Purge all the pods but instances with data persists</h3>
<p>On restarting we need to make sure that we remove all files in the path: /var/lib/cassandra/data/system/*</p>
<p>If not done the last cluster state causes the second pod to enter a crash loop backoff and it causes problems for cluster to start.</p>
<p>Performing this operation still has no impact on data. Remember we are only deleting data in the system keyspace, the rest of the keyspace data is still kept intact.</p>
<p>Note: This should only be done when the entire cluster was purged and previous data still persists.</p>
<h3>Case 2: Delete a cluster pod; Instance and data persists.</h3>
<p>This case has two scenarios:</p>
<ol>
<li>Deleted pod is a seed node.</li>
<li>Deleted pod is a non-seed node.
In both the cases deleting the pod has no affect in availability of data from cluster. We can delete the pod and on the same instance the same pod starts (stateful-set construct at work in k8s) and it starts up properly connecting back to the ring in the cluster.</li>
</ol>
<h3>Case 3: Scale up the cluster</h3>
<p>Generally, if you start some new nodes with proper configuration values (mainly seeds and cluster_name), they should eventually join the cluster and then receive their portion of data from other nodes. This process is called bootstrapping.</p>
<p>However, if two or more nodes try to bootstrap at the same time, one might fail to proceed until the other one has finished his job. In logs, you might find corresponding exceptions:</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">Exception (java.lang.UnsupportedOperationException) encountered during startup:
Other bootstrapping/leaving/moving nodes detected, cannot bootstrap while cassandra.consistent.rangemovement is true</code></pre></div>
<p>But as said, this is not critical issue: cassandra will retry bootstrapping over and over again until succeeded.
More details discussed in depth in <a href="http://thelastpickle.com/blog/2017/05/23/auto-bootstrapping-part1.html">this article</a></p>
<h3>Case 4: Remove or downscale the cluster nodes</h3>
<ol>
<li>Run nodetool drain &#x26;&#x26; nodetool stopdaemon on node planned for removal</li>
<li>Run nodetool status on any other node in the cluster. Make sure that the victim node is marked as DN</li>
<li>Run nodetool removenode <GUID> with victim’s GUID. This command will take some time.</li>
<li>To remove all nodes that are down, run the same stuff in a loop, like:
for node in <code class="language-text">nodetool status | grep ^DN | awk {&#39;print $7&#39;}</code>; do nodetool removenode $node; done</li>
</ol>
<h3>Case 5: Replacing dead node</h3>
<p>Can be achieved by:</p>
<ol>
<li>removing dead node as described in Case 6</li>
<li>starting a new node as described in Case 5
However, there is more efficient way possible to add <a href="http://thelastpickle.com/blog/2017/05/23/auto-bootstrapping-part1.html#adding-a-replacement-node">a replacement node</a></li>
</ol>
<h3>Case 6: What happens when disk becomes full</h3>
<p>This section explains what kinds of issues might arise when the disk where cassandra data folder resides, becomes full.</p>
<p>The main thing we should know is that cassandra does not consider this case as critical, so if node is unable to do a planned background compaction, it won’t just do it. As far as there is enough space in commitlog pool, all data writes will still be stored in commitlog. However, commitlog maximum size is controlled by commitlog<em>total</em>space<em>in</em>mb config property, and by default its set to several gigabytes. For performance reasons, its not recommended to increase this value too much. So if you keep writing new data, commitlog will also get full.</p>
<p>After that, all writes to this node will fail, while node will still try to stay up and running. In particular, nodetool status will still report node as UN (up normal).</p>
<p>Depending on cluster configuration, replication<em>factor property and desired consistency level, a client who is doing writes to the cluster might not notice any issue. So for example if we have more than 1 node in cluster, use replication</em>factor = 2 and consistency ONE, any write request will be successful, because second replica will always successfully go to another, healthy node.</p>
<p>But in practice things may work differently. As of cassandra 3.11.2, such an overloaded node seems to work quite unstable, so over time service may die with following log messages:</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">java.lang.OutOfMemoryError: Java heap space
Dumping heap to java_pid2795.hprof ...
Unable to create java_pid2795.hprof: Permission denied

    java.lang.OutOfMemoryError: Java heap space
 -XX:OnOutOfMemoryError=&quot;kill -9 %p&quot;
   Executing /bin/sh -c &quot;kill -9 2795&quot;...
bash: line 1:  2795 Killed                  docker-entrypoint.sh</code></pre></div>
<p>After restarting the service, while there is still no free space left on device, cassandra might behave unpredictably. For example, some subservices would start normally, and others not. But if you first free up some space and then restart it again, cassandra will start normally.
Therefore, you need to make sure you have some smart policy for service healthcheck and restarting.</p>
<h3>Case 7: <a href="https://opencredo.com/cassandra-tombstones-common-issues/">Tombstones: common issues</a></h3></section><hr style="margin-bottom:1.75rem"/><footer><div style="display:flex;margin-bottom:4.375rem"><a style="min-width:50px;min-height:50px;margin-right:0.875rem;margin-bottom:0;overflow:hidden;box-shadow:none" href="/author/abhi"><img alt="Abhijeet Dhumal" style="width:50px;height:auto;border-radius:100%" src="/abhi.jpg"/></a><p><strong>Abhijeet Dhumal</strong> <!-- --> is a professional software developer; has a strong experience of designing and developing distributed, big data and cloud applications<!-- -->.<br/><a target="_blank" rel="noopener noreferrer" href="https://twitter.com/abhijeetdhumal">@<!-- -->abhijeetdhumal</a></p></div></footer></article><nav><ul style="display:flex;flex-wrap:wrap;justify-content:space-between;list-style:none;padding:0"><li><a rel="prev" href="/confluent-salesforce-connector/">← <!-- -->Salesforce Connector for Confluent Platform</a></li><li><a rel="next" href="/terraform-aws-elasticsearch/aws-elasticsearch/">Terraform script for Amazon Elasticsearch Service with Cognito authentication<!-- --> →</a></li></ul></nav><div id="disqus_thread"></div></main></div></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/working-with-cassandra/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-58c38faf7e2e99e839fb.js"],"component---src-templates-blog-post-js":["/component---src-templates-blog-post-js-b10f2a3014285766b4ab.js"],"component---src-templates-tag-js":["/component---src-templates-tag-js-4c6d0acf187afb07fe01.js"],"component---src-templates-author-js":["/component---src-templates-author-js-a61200afc35cc97c7008.js"],"component---src-pages-404-js":["/component---src-pages-404-js-31a64aa4d0648eac1c8c.js"],"component---src-pages-index-js":["/component---src-pages-index-js-243a263376f386d41bfe.js"]};/*]]>*/</script><script src="/component---src-templates-blog-post-js-b10f2a3014285766b4ab.js" async=""></script><script src="/commons-b9db83118e7f66f55c18.js" async=""></script><script src="/styles-05ec49f1e97fde7879c1.js" async=""></script><script src="/app-58c38faf7e2e99e839fb.js" async=""></script><script src="/webpack-runtime-2c7cf114e72f8be8c654.js" async=""></script></body><script>
            const ts = Date.now().toString();
            const sendTelemetry = () => {
              // avoid localhost hits
              if (window.location.href.includes("localhost")) return;
              // Analytics
              let query = "v=1";
              query += "&tid=UA-176302969-1"; // tracking ID
              query += "&cid=" + ts; // client ID -> faking as timestamp
              if (document.referrer) query += "&dr="+ encodeURIComponent(document.referrer);
              query += "&ds=web"; // event from
              query += "&aip=1"; //anonymize IP
              query += "&z=" + ts; //to avoid caching of data
              query += "&ul=" + navigator.language;
              query += "&ua=" + encodeURIComponent(navigator.userAgent);
              query += "&dl=" + encodeURIComponent(document.location.origin + document.location.pathname);
              // query += "&dh=" + encodeURIComponent(document.location.origin);
              // query += "&dp=" + encodeURIComponent(document.location.pathname);
              query += "&t=pageview"; //event type
              const request = new XMLHttpRequest();
              request.open("POST", "https://www.google-analytics.com/collect", true);
              request.send(query);
            };

            // Send for the current page
            sendTelemetry();
            // hook pushState function to call sendTelemetry everytime something is pushed in history
            (function(history){
              var pushState = history.pushState;
              history.pushState = function(state) {
                sendTelemetry();
                return pushState.apply(history, arguments);
              };
            })(window.history);
          </script></html>
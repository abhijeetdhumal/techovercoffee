{"componentChunkName":"component---src-templates-blog-post-js","path":"/confluent-salesforce-connector/","result":{"data":{"site":{"siteMetadata":{"title":"Backtracking Dev","siteUrl":"https://backtracking.dev"}},"markdownRemark":{"id":"e61fa09d-3574-58ff-8c3a-2c49ef243324","excerpt":"Recently, I have been trying to develop quick proof of concept using salesforce-kafka connector provided by confluent. Although documentation available at…","html":"<p>Recently, I have been trying to develop quick proof of concept using salesforce-kafka connector provided by confluent.</p>\n<p>Although documentation available at confluent is comprehensive, it still lacks a bit of information. Hence, I thought of sharing this blog with a working example.</p>\n<p>In this blog post, we will synchronize the object from one salesforce org to another org using salesforce-kafka connector.</p>\n<p>The below diagram depicts the scenario and components required to complete the poc.\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/657c8532bad08e94589cc7bbb263e330/20362/sf-kafka-sync.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 44.9868073878628%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsSAAALEgHS3X78AAAB50lEQVQoz22RTW/TQBCG8///AAcuqOIEJ+CCuFRCqKgtaeI4drz58OfaiR17N42d5svpwzal5dKRRrs7O/PMaN7O8XhA1Rq9eUA19+hGoc1brRWlLmnblhd7uj/Fdf3PG5NXr861y5XiYFidpErxwi5T5xOT2TVeMGESjfFmHjfONQu9eAWmlUSkgnEwZmxyRr5gFtlMhp/53f2GLDM6YRGR5FOq4JKq8JnnBVVV4rouru8wX2WvwKSKcWZDhBAorVjkOdo0LP1L/OiGRBlgXEbYUwtXeNjCwfZs7GBAL77jLu6yWP2fMNMZf8Jb+nEPS/YZGO8lpjZzz7FUpXSkThmEV3hRHz+eGfCQvttnHApc6ZyTXixeRoykiwg8LM/CEhbhPGCU9gz45hkYZTEi7JuPsYF1mQS22UWKXCZEeUizbV6B683axCLSpTT/kjiPGXm3Zt93jCIHvdZ06npDu7lnZ9SqqwVbo/Rb9vhG7HR6pDZCtKbp/mHL8djS2e12FPkcfzpBGzFWaokql2zkd9LBezLngnT4gcL7iLQviAcXlKN3lNKiLApUkRFHEbkRaL/fPwObpqEsK3NuOOx35+7bykbLn1TJL6bWF2aDryTiB0pesU4vaXclj6eTqalRSlHXtZnwyF+qSpmFpbSL+QAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"sf kafka sync\"\n        title=\"sf kafka sync\"\n        src=\"/static/657c8532bad08e94589cc7bbb263e330/799d3/sf-kafka-sync.png\"\n        srcset=\"/static/657c8532bad08e94589cc7bbb263e330/00d96/sf-kafka-sync.png 148w,\n/static/657c8532bad08e94589cc7bbb263e330/0b23c/sf-kafka-sync.png 295w,\n/static/657c8532bad08e94589cc7bbb263e330/799d3/sf-kafka-sync.png 590w,\n/static/657c8532bad08e94589cc7bbb263e330/20362/sf-kafka-sync.png 758w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<ul>\n<li>We need two salesforce org logins. The user will insert/update objects in org A and kafka-connect will synchronize it in org B.</li>\n<li>There are already many inbuilt objects available in Salesforce; we can create the custom objects as well. We will use <strong>Leads</strong> object in this poc.</li>\n<li>We need to create PushTopic using SOQL in org A. With this setup, client can subscribe to PushTopic and any changes made to Leads object will be notified to client.</li>\n<li>Clients have to authenticate themselves before accessing the salesforce objects. Connected App generates necessary credentials like a secret key, access key using which clients will authenticate.</li>\n<li>Kafka connect source connector will subscribe to PushTopic and authenticate itself using credentials generated by the connected app. Once it receives the message, it will publish the event message in Avro format to Kafka topic.</li>\n<li>Kafka connect sink connector consumes the messages from the same Kafka topic and perform the upsert on Leads object in org B.</li>\n<li>Sink connector will require authentication credentials as well; hence, we need to create the Connected App in org B.</li>\n</ul>\n<h2>Initial Setup</h2>\n<p>Let’s do some initial setup and installation before we run actual poc.</p>\n<h3>Salesforce Org A</h3>\n<ul>\n<li>Create a new org with Developer/Unlimited/Enterprise edition. Don’t create org with Professional edition as you cannot deploy custom apex code on the professional edition.</li>\n<li>Verify your account</li>\n<li>Check your email inbox. In case you don’t find an email with your security token, click on profile picture -> settings -> My Personal Information -> Reset My Security Token.</li>\n<li>You will receive the security token in your email. Note down the security token.</li>\n<li>Click on Set up icon <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 306px;\">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/c9e3edb7cfa5a238c203cb8c2acf7adf/3dc04/setup-icon.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 30.718954248366014%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAABYlAAAWJQFJUiTwAAABC0lEQVQY04VRTUuEUBT1L7qZ/1C/wE1LaTFDuwLbFQwIQbNJGCKL2jg8UEz60KStNEio8XRGTE++azpTBB24vHvuO/fc9yE1TYMeIhdR1zVFv9fXO96u3/pVwfGRpT/6JZGUZUkGf2F7oECvc9wnTM9vMZszXN4sukGtlAwty4JhGEOTbdvE8zwn7nkeFEVBlmXE16sCJ2fXGO0eYLQzwd54ijTtTkqGURTBNE0qVFUFTdOgqiqCIKCaruuQZRmu6xIvco6j0zkWzgui5Tv2D2d4W8YbwyRJhgkCYRiCMUbmAnEcw/d9cM43t7j3MTm+wLiNqzsH9WenlX5/yn9vuM0fn1/BnIdhsNj7Al57vTrRi9bkAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"setup\" title=\"setup\" src=\"/static/c9e3edb7cfa5a238c203cb8c2acf7adf/3dc04/setup-icon.png\" srcset=\"/static/c9e3edb7cfa5a238c203cb8c2acf7adf/00d96/setup-icon.png 148w,\n/static/c9e3edb7cfa5a238c203cb8c2acf7adf/0b23c/setup-icon.png 295w,\n/static/c9e3edb7cfa5a238c203cb8c2acf7adf/3dc04/setup-icon.png 306w\" sizes=\"(max-width: 306px) 100vw, 306px\" loading=\"lazy\">\n  </a>\n    </span> on top right.</li>\n<li>Search “App” in “Search Setup” textbox and click on “App Manager”.</li>\n<li>Enter the required fields and select “Enable OAuth Settings”.</li>\n<li>Select “Enable for Device Flow” and then select All OAuth Scopes and Click on “next/save”.\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/19acf4621331fda8b152bcd1c632c3f4/19f87/connected-app.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 45.298165137614674%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAABjklEQVQoz4WRS2vCQBSF/f//QTe60IUvcCG6EEQQRMHGqvVZazUFyWvSxCQT4+ncq2JtC71wuJDJfJxzJuUID2/bPZ60CTRtjOeXV+i2RBhG8I+P8vzwX6VwHd/3YRgGTEvgwzgiCgMFDRFFodoB63Q64XxOkCSJ2mf8NSk6uClQro6uC3v3Dlu4EELAcRxYlgXTNBEEFyhJypgBBL/rfHFIMMcRMEwLn+4njp6HSEp2SJd/Dn2L45ghvxzegJ7nq54CBMqhud1isVpB3+/5p73amqZhOp1iPB6j0+mg1+thOBxis9nw+VbdORwOl8gPIyMkKmpMPV2jtFotZDIZZLNZVi6XQz6fR7lcZvhgMEC328VkMvnWIQGoExVT2jYDExXNVP21222USiVUKhXepFqthnq9zqB+v89aLBb3V747lDjZFgOpJxoCptNpFAoFVKtVFItFFjlsNBpoNpucYjQaIUUvZ6rHsCyb5dgCrgggFewG1HWdu5vP51ipbskJ7eVyyXu9XmM2m2G32+EL0eWdgEUDY4wAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"API\"\n        title=\"API\"\n        src=\"/static/19acf4621331fda8b152bcd1c632c3f4/799d3/connected-app.png\"\n        srcset=\"/static/19acf4621331fda8b152bcd1c632c3f4/00d96/connected-app.png 148w,\n/static/19acf4621331fda8b152bcd1c632c3f4/0b23c/connected-app.png 295w,\n/static/19acf4621331fda8b152bcd1c632c3f4/799d3/connected-app.png 590w,\n/static/19acf4621331fda8b152bcd1c632c3f4/2a3d6/connected-app.png 885w,\n/static/19acf4621331fda8b152bcd1c632c3f4/ae92f/connected-app.png 1180w,\n/static/19acf4621331fda8b152bcd1c632c3f4/19f87/connected-app.png 1744w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></li>\n<li>Note down “secret key” and “access key”.</li>\n</ul>\n<p> Let’s create PushTopic for Leads Object</p>\n<ul>\n<li>Go to Setup -> Developer Console.</li>\n<li>Open Apex Code Editor. On mac, use CMD+E shortcut.</li>\n<li>\n<p>Execute below code</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token class-name\">PushTopic</span> pushTopic <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">PushTopic</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\npushTopic<span class=\"token punctuation\">.</span><span class=\"token class-name\">Name</span> <span class=\"token operator\">=</span> <span class=\"token string\">'LeadsPushTopic'</span><span class=\"token punctuation\">;</span>\npushTopic<span class=\"token punctuation\">.</span><span class=\"token class-name\">Query</span> <span class=\"token operator\">=</span> <span class=\"token string\">'SELECT Id, Name, FirstName, LastName, Company FROM Lead'</span><span class=\"token punctuation\">;</span>\npushTopic<span class=\"token punctuation\">.</span><span class=\"token class-name\">ApiVersion</span> <span class=\"token operator\">=</span> <span class=\"token number\">49.0</span><span class=\"token punctuation\">;</span>\npushTopic<span class=\"token punctuation\">.</span><span class=\"token class-name\">NotifyForOperationCreate</span> <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\npushTopic<span class=\"token punctuation\">.</span><span class=\"token class-name\">NotifyForOperationUpdate</span> <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\npushTopic<span class=\"token punctuation\">.</span><span class=\"token class-name\">NotifyForOperationUndelete</span> <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\npushTopic<span class=\"token punctuation\">.</span><span class=\"token class-name\">NotifyForOperationDelete</span> <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\npushTopic<span class=\"token punctuation\">.</span><span class=\"token class-name\">NotifyForFields</span> <span class=\"token operator\">=</span> <span class=\"token string\">'Referenced'</span><span class=\"token punctuation\">;</span>\ninsert pushTopic<span class=\"token punctuation\">;</span></code></pre></div>\n</li>\n<li>You can choose any number of fields you want, but make sure you select all mandatory fields.</li>\n<li>For Leads object, mandatory fields are - Id, LastName, and Company.</li>\n</ul>\n<p>We are done with set up of org A. Lets move to org B.</p>\n<h3>Salesforce Org B</h3>\n<ul>\n<li>Follow the same steps as above except you don’t have to create PushTopic in org B</li>\n<li>Note: You can use the same email, specify a different username while creating a salesforce account.</li>\n</ul>\n<h3>Confluent Platform</h3>\n<ul>\n<li>\n<p>Download the confluent tar</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">wget</span> https://packages.confluent.io/archive/5.5/confluent-5.5.0-2.12.tar.gz</code></pre></div>\n</li>\n<li>Make sure Java8 or Java11 is installed on your machine, and JAVA_HOME is set.</li>\n<li>\n<p>Unarchive the confluent tar file and update the $PATH to include “confluent5.5/bin”</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">cat</span> ~/.bash_profile\n<span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\">CONFLUENT_HOME</span><span class=\"token operator\">=</span><span class=\"token operator\">&lt;</span>path-to-confluent<span class=\"token operator\">></span>\n<span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\"><span class=\"token environment constant\">PATH</span></span><span class=\"token operator\">=</span><span class=\"token string\">\"<span class=\"token variable\">${CONFLUENT_HOME}</span>/bin:<span class=\"token environment constant\">$PATH</span>\"</span></code></pre></div>\n</li>\n<li>\n<p>Install the confluent salesforce connector.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">confluent-hub <span class=\"token function\">install</span> confluentinc/kafka-connect-salesforce:1.5.9</code></pre></div>\n</li>\n<li>Note: Don’t use version 1.6.4, which is broken. I have already raised the defect with the confluent team.</li>\n<li>\n<p>Start the confluent platform services.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">confluent <span class=\"token builtin class-name\">local</span> start</code></pre></div>\n</li>\n</ul>\n<h2>Proof of Concept</h2>\n<h3><em>Source Connector</em></h3>\n<h4><strong>Config file</strong></h4>\n<p>Create below config file (salesforce-pushtopic-lead-source-config.json)\nand replace credentials that you saved previously.</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n     <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"lead-pushtopic\"</span><span class=\"token punctuation\">,</span>\n     <span class=\"token property\">\"config\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n         <span class=\"token property\">\"connector.class\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"io.confluent.salesforce.SalesforcePushTopicSourceConnector\"</span><span class=\"token punctuation\">,</span>\n         <span class=\"token property\">\"tasks.max\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"1\"</span><span class=\"token punctuation\">,</span>\n         <span class=\"token property\">\"kafka.topic\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"sfdc-pushtopic-leads\"</span><span class=\"token punctuation\">,</span>\n         <span class=\"token property\">\"salesforce.object\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"Lead\"</span><span class=\"token punctuation\">,</span>\n         <span class=\"token property\">\"salesforce.push.topic.name\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"LeadsPushTopic\"</span><span class=\"token punctuation\">,</span>\n         <span class=\"token property\">\"salesforce.username\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"&lt;org_A_username>\"</span><span class=\"token punctuation\">,</span>\n         <span class=\"token property\">\"salesforce.password\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"&lt;password>\"</span><span class=\"token punctuation\">,</span>\n         <span class=\"token property\">\"salesforce.password.token\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"&lt;security_token>\"</span><span class=\"token punctuation\">,</span>\n         <span class=\"token property\">\"salesforce.consumer.key\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"&lt;connected_app_consumer_key>\"</span><span class=\"token punctuation\">,</span>\n         <span class=\"token property\">\"salesforce.consumer.secret\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"&lt;connected_app_secret_key>\"</span><span class=\"token punctuation\">,</span>\n         <span class=\"token property\">\"salesforce.initial.start\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"all\"</span><span class=\"token punctuation\">,</span>\n\t     <span class=\"token property\">\"salesforce.instance\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"https://login.salesforce.com\"</span><span class=\"token punctuation\">,</span>\n         <span class=\"token property\">\"confluent.topic.bootstrap.servers\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"localhost:9092\"</span><span class=\"token punctuation\">,</span>\n         <span class=\"token property\">\"confluent.topic.replication.factor\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"1\"</span>\n     <span class=\"token punctuation\">}</span>\n <span class=\"token punctuation\">}</span></code></pre></div>\n<h4><strong>Fork the source connector</strong></h4>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">confluent <span class=\"token builtin class-name\">local</span> load lead-pushtopic -- -d salesforce-pushtopic-lead-source-config.json</code></pre></div>\n<h4><strong>Kafka connect logs</strong></h4>\n<p>You can check the connect logs using below command.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">confluent <span class=\"token builtin class-name\">local</span> log connect -- -f</code></pre></div>\n<h4><strong>Salesforce console</strong></h4>\n<ul>\n<li>Login to Salesforce org A</li>\n<li>Open Leads Item from home page <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/254e0ed48aed14ea5aa05e1077691f3b/581a4/leads-app.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 74.10714285714286%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAABYlAAAWJQFJUiTwAAACDUlEQVQ4y6WT2W7TQBSG/Wi8CeIGWhYh8QB9iSJEoaJSH4K7Fqk7oSylUOQ2m7PZyUwcL2M7cWx/jB2g3JGWI/3SmZl//jnLHIMip92sk0QhKvC036BrtcjnKaWF/gQxtEliVa2dQQ8phniuRI4cxtovMs3NM7SDEUwzal++Yzluhd3DD+zXzhiMFcEMGr0RZ2aLZl8wiXM+XzT4dFHnR7PHV7Ot0dLcEHsSMVYpxp21txyakq13de6u7/Fs+5Qnb2o8eHnA/Rd7rL464uHrEx5tHrO6ccDjzROebtX03jErG0fVemXjUOOAe8/3MNa290nmBf3JjI5M6LlTLBHTGSd0Nco9S16vK/8XKl7ll2dTGgMPw+xIRJjhBQrHcbiq16taFfzbfnOmScLHs29IraMFRVUr/RjDINORThnqg9JfCiXXT2kOI9xQ17Dl+FVXd3Z26Q8G1Yt5XpAXN8Ei0iybY7QdjzDwabfbRFHEfD6nKJZJ+O/cF/zyrtEdBXgTl063i2VZnJ+fV8ILXrE0/gja+r9JMeLy8qpqyvWjxY1ES4uTGYbwYi1kY5omPR3l/1iW5xhD6eNKSbPRRAhBpCJUGN4YsS6T1PcN4Yb0OhantffY/a7+U/GtBCOlR9X3McYTRazn2dYT0pcKT01vnfIsTRcRqijGFj6jcUCgYt2tlDRdHrNZWnU4DBU/AVFRbu/yL7v/AAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"leads\" title=\"leads\" src=\"/static/254e0ed48aed14ea5aa05e1077691f3b/799d3/leads-app.png\" srcset=\"/static/254e0ed48aed14ea5aa05e1077691f3b/00d96/leads-app.png 148w,\n/static/254e0ed48aed14ea5aa05e1077691f3b/0b23c/leads-app.png 295w,\n/static/254e0ed48aed14ea5aa05e1077691f3b/799d3/leads-app.png 590w,\n/static/254e0ed48aed14ea5aa05e1077691f3b/581a4/leads-app.png 672w\" sizes=\"(max-width: 590px) 100vw, 590px\" loading=\"lazy\">\n  </a>\n    </span></li>\n<li>Add one entry into Leads</li>\n</ul>\n<h4><strong>Validate the source connector</strong></h4>\n<ul>\n<li>Once you add new records in Leads object, you should see data in kafka topic in avro format.</li>\n<li>\n<p>Use kafka-avro-consumer to see message.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kafka-avro-console-consumer --bootstrap-server localhost:9092 --from-beginning --topic sfdc-pushtopic-leads</code></pre></div>\n</li>\n<li>\n<p>Record should look like something below with additional fields of Lead object.</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n<span class=\"token property\">\"Id\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"00Q3V000002o9aiUAA\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token property\">\"LastName\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token property\">\"string\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Barapatre\"</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token property\">\"FirstName\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token property\">\"string\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Pari\"</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token property\">\"Salutation\"</span><span class=\"token operator\">:</span> <span class=\"token null keyword\">null</span><span class=\"token punctuation\">,</span>\n<span class=\"token property\">\"Name\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token property\">\"string\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Pari Barapatre\"</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token property\">\"Company\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token property\">\"string\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"XYZ\"</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token property\">\"_ObjectType\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token property\">\"string\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Lead\"</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token property\">\"_EventType\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token property\">\"string\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"created\"</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n</li>\n<li>If you don’t any see record populated in kafka-topic, check the kafka-connect logs.</li>\n</ul>\n<h3><em>Sink Connector</em></h3>\n<h4><strong>Config file</strong></h4>\n<p>Create a config file (salesforce-sobject-leads-sink-config.properties)\nand replace credentials that you saved previously.</p>\n<p> Here we are using “properties” file instead of json. You can use json file as well. Confluent supports both json and properties file.</p>\n<div class=\"gatsby-highlight\" data-language=\"properties\"><pre class=\"language-properties\"><code class=\"language-properties\"><span class=\"token attr-name\">name</span><span class=\"token punctuation\">=</span><span class=\"token attr-value\">sink-leads</span>\n<span class=\"token attr-name\">connector.class</span><span class=\"token punctuation\">=</span><span class=\"token attr-value\">io.confluent.salesforce.SalesforceSObjectSinkConnector</span>\n<span class=\"token attr-name\">tasks.max</span><span class=\"token punctuation\">=</span><span class=\"token attr-value\">1</span>\n<span class=\"token attr-name\">topics</span><span class=\"token punctuation\">=</span><span class=\"token attr-value\">sfdc-pushtopic-leads</span>\n<span class=\"token attr-name\">salesforce.object</span><span class=\"token punctuation\">=</span><span class=\"token attr-value\">Lead</span>\n<span class=\"token attr-name\">\"salesforce.username\"</span> <span class=\"token punctuation\">:</span> <span class=\"token attr-value\">\"&lt;org_A_username>\",</span>\n<span class=\"token attr-name\">\"salesforce.password\"</span> <span class=\"token punctuation\">:</span> <span class=\"token attr-value\">\"&lt;password>\",</span>\n<span class=\"token attr-name\">\"salesforce.password.token\"</span> <span class=\"token punctuation\">:</span> <span class=\"token attr-value\">\"&lt;security_token>\",</span>\n<span class=\"token attr-name\">\"salesforce.consumer.key\"</span> <span class=\"token punctuation\">:</span> <span class=\"token attr-value\">\"&lt;connected_app_consumer_key>\",</span>\n<span class=\"token attr-name\">\"salesforce.consumer.secret\"</span> <span class=\"token punctuation\">:</span> <span class=\"token attr-value\">\"&lt;connected_app_secret_key>\",</span>\n<span class=\"token attr-name\">salesforce.ignore.fields</span><span class=\"token punctuation\">=</span><span class=\"token attr-value\">CleanStatus</span>\n<span class=\"token attr-name\">salesforce.ignore.reference.fields</span><span class=\"token punctuation\">=</span><span class=\"token attr-value\">true</span>\n<span class=\"token attr-name\">salesforce.custom.id.field.name</span><span class=\"token punctuation\">=</span><span class=\"token attr-value\">CustomId__c</span>\n<span class=\"token attr-name\">salesforce.use.custom.id.field</span><span class=\"token punctuation\">=</span><span class=\"token attr-value\">true</span>\n<span class=\"token attr-name\">salesforce.sink.object.operation</span><span class=\"token punctuation\">=</span><span class=\"token attr-value\">upsert</span>\n<span class=\"token attr-name\">override.event.type</span><span class=\"token punctuation\">=</span><span class=\"token attr-value\">true</span>\n<span class=\"token attr-name\">confluent.topic.bootstrap.servers</span><span class=\"token punctuation\">=</span><span class=\"token attr-value\">localhost:9092</span>\n<span class=\"token attr-name\">confluent.topic.replication.factor</span><span class=\"token punctuation\">=</span><span class=\"token attr-value\">1</span></code></pre></div>\n<p>There are three major differences in sink config from source config.</p>\n<ul>\n<li>We don’t need salesforce.push.topic.name in sink config</li>\n<li>salesforce.custom.id.field.name property required for kafka connect to identify the record.\nId field is maintained by salesforce and cannot be overriden. Hence, we need extra custom field which will be set by kafka-connect as OrgA<em>Lead</em>Id field before upserting record to OrgB_Lead object. </li>\n<li>salesforce.sink.object.operation property specifies the operation we intended to perform.</li>\n</ul>\n<h4><strong>Salesforce console</strong></h4>\n<p>As mentioned above, we now have to create a custom field in Leads object of org B.</p>\n<ul>\n<li>Log in to org B salesforce console.</li>\n<li>Go to Set Up -> Object Manager -> Lead -> Fields &#x26; Relationship -> New</li>\n<li>Select ‘text’ field -> Next -> Name the field, Set it as “External Field” and Next->Next->Save</li>\n</ul>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/f0dd41ca91ebc2ad85aaff3800924b3b/da2b8/custom_field.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 71.54471544715447%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAABYlAAAWJQFJUiTwAAAB+klEQVQ4y51T2ZLaMBD0//8XtZWEGwy2AxhfGN+HbDBnRzMbudiEl8RVXZJHUqt7ZqSdz2eUZYU8L1CXJdJjjCCMcIwSFFUjIVCUAlXd4HQ6/QU6/wqt6zqkaQbXC5AeQmyXBoZzE7phIy7OSCRoTAuBkzxwvV57XC4XJiEOBY0CtHC/33F/3CHaBo2oUVUFyiJHkWc8ZlkqkUknOZIkYdR1zSRfFCrCQKpLwyMWoym+jXUYGw9ry8F8tYVu7mFaWxyCAL4fwHVdOI4jnaW9yi+W4zjBz62NyHFh/hhhqlvY7Dy2mZUNj5RHOny73Xr8SdYrDIIDtrs9YqkwCUiBg/AQoG2k/UagbQUXrhafhWnblvGuSEzYyMVGHhYSnbyVvufz+ZlXiZvEQ81fFL6DRrKLooTn+TLRKYQQEg1f8D/gHJJUIiEymj8eD75NKfwXaKqPSKkif02y+n+XL7WmckroLe9kUchyVVWwbRv7/Z5bw/M8bhP6p7jv+zynOIHmZFUJ0lRjEuHxGMnmzWFZFtbrNWM+n8MwDJimyY3c/i7gqyrlrH8pr5YvnbQnNxHZcDjEcrnEbDbDYrHAdDrFYDDAZDLhtdFoxPj4+EAYhvwcWWEUxVK6y8/su91hY7tY6UsmI+LVasUqdV3HeDxmcopTjC6hfWSfuH4BqRMkAu+/vysAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"CustomId\" title=\"CustomId\" src=\"/static/f0dd41ca91ebc2ad85aaff3800924b3b/799d3/custom_field.png\" srcset=\"/static/f0dd41ca91ebc2ad85aaff3800924b3b/00d96/custom_field.png 148w,\n/static/f0dd41ca91ebc2ad85aaff3800924b3b/0b23c/custom_field.png 295w,\n/static/f0dd41ca91ebc2ad85aaff3800924b3b/799d3/custom_field.png 590w,\n/static/f0dd41ca91ebc2ad85aaff3800924b3b/2a3d6/custom_field.png 885w,\n/static/f0dd41ca91ebc2ad85aaff3800924b3b/da2b8/custom_field.png 984w\" sizes=\"(max-width: 590px) 100vw, 590px\" loading=\"lazy\">\n  </a>\n    </span>\n<h4><strong>Fork the sink connector</strong></h4>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">confluent <span class=\"token builtin class-name\">local</span> load lead-sink -- -d salesforce-sobject-leads-sink-config.properties</code></pre></div>\n<h4><strong>Kafka connect logs</strong></h4>\n<p>You can check the connect logs using the below command.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">confluent <span class=\"token builtin class-name\">local</span> log connect -- -f</code></pre></div>\n<h4><strong>Validate the sink connector</strong></h4>\n<ul>\n<li>Login to Salesforce org B</li>\n<li>Open Leads Item from home page <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/254e0ed48aed14ea5aa05e1077691f3b/581a4/leads-app.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 74.10714285714286%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAABYlAAAWJQFJUiTwAAACDUlEQVQ4y6WT2W7TQBSG/Wi8CeIGWhYh8QB9iSJEoaJSH4K7Fqk7oSylUOQ2m7PZyUwcL2M7cWx/jB2g3JGWI/3SmZl//jnLHIMip92sk0QhKvC036BrtcjnKaWF/gQxtEliVa2dQQ8phniuRI4cxtovMs3NM7SDEUwzal++Yzluhd3DD+zXzhiMFcEMGr0RZ2aLZl8wiXM+XzT4dFHnR7PHV7Ot0dLcEHsSMVYpxp21txyakq13de6u7/Fs+5Qnb2o8eHnA/Rd7rL464uHrEx5tHrO6ccDjzROebtX03jErG0fVemXjUOOAe8/3MNa290nmBf3JjI5M6LlTLBHTGSd0Nco9S16vK/8XKl7ll2dTGgMPw+xIRJjhBQrHcbiq16taFfzbfnOmScLHs29IraMFRVUr/RjDINORThnqg9JfCiXXT2kOI9xQ17Dl+FVXd3Z26Q8G1Yt5XpAXN8Ei0iybY7QdjzDwabfbRFHEfD6nKJZJ+O/cF/zyrtEdBXgTl063i2VZnJ+fV8ILXrE0/gja+r9JMeLy8qpqyvWjxY1ES4uTGYbwYi1kY5omPR3l/1iW5xhD6eNKSbPRRAhBpCJUGN4YsS6T1PcN4Yb0OhantffY/a7+U/GtBCOlR9X3McYTRazn2dYT0pcKT01vnfIsTRcRqijGFj6jcUCgYt2tlDRdHrNZWnU4DBU/AVFRbu/yL7v/AAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"leads\" title=\"leads\" src=\"/static/254e0ed48aed14ea5aa05e1077691f3b/799d3/leads-app.png\" srcset=\"/static/254e0ed48aed14ea5aa05e1077691f3b/00d96/leads-app.png 148w,\n/static/254e0ed48aed14ea5aa05e1077691f3b/0b23c/leads-app.png 295w,\n/static/254e0ed48aed14ea5aa05e1077691f3b/799d3/leads-app.png 590w,\n/static/254e0ed48aed14ea5aa05e1077691f3b/581a4/leads-app.png 672w\" sizes=\"(max-width: 590px) 100vw, 590px\" loading=\"lazy\">\n  </a>\n    </span></li>\n<li>You should see one entry from org A</li>\n<li>Edit/Add a record in org A, and it should appear in org B in blink of an eye.</li>\n</ul>\n<h2>Clean up</h2>\n<p>Run below command to stop all services and delete data.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">confluent <span class=\"token builtin class-name\">local</span> destroy</code></pre></div>","frontmatter":{"title":"Salesforce Connector for Confluent Platform","tags":["kafka","salesforce","confluent","kafka-connect"],"date":"August 24, 2020","description":"Salesforce Connector for Confluent Platform(Kafka)","author":"pari","featuredImage":{"childImageSharp":{"fluid":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAIAAAAC64paAAAACXBIWXMAAAsSAAALEgHS3X78AAABaUlEQVQ4y9VTPc/BYBT1n/gbRtIuZTDqYDE0hnaoj0haIdLWoEEYahQJA4kf0EWkEZIuIpFYSKpUte97XgbEJAZ57/Q8T+6595xz7xP4+SAC3wb7vv+Nzq7r6rp+Pp/R/3K5vAeu1WrxeLxSqeDsed574FarlUgkVFXt9Xq5XO5wOByPR8uy9tc4nU7b7Xa1Wt2oede4efQHns/noVBI0zSCIGKxGEooijKdTqHFMIzFYlEsFvP5/HA4RPKjroDjOOl0ejAYRKPRUqnUaDTQjef5yWQym82azeZ4PE4mkxAly/Jyuez3++12e7fbPYEjkYgoiiCP2uFwmKbpQqEAMJBIqFarwWBQkqRyucyy7Gg0eqLd7XZJkqQoCrUFQchkMujPcRzDMDAFnG/lstlsKpXqdDq2bd8Nq9frUAttMAyWWNcwTRNXsMM44RwAm81mvV7DPOTcRwU+j6N63bnXl4+X5J9+jO+AfwEnkj22tMsBBQAAAABJRU5ErkJggg==","aspectRatio":1,"src":"/static/f2801a2555451906d4e0ced138039b0f/a54c6/apache-kafka.png","srcSet":"/static/f2801a2555451906d4e0ced138039b0f/59beb/apache-kafka.png 200w,\n/static/f2801a2555451906d4e0ced138039b0f/c0bbd/apache-kafka.png 400w,\n/static/f2801a2555451906d4e0ced138039b0f/a54c6/apache-kafka.png 800w,\n/static/f2801a2555451906d4e0ced138039b0f/9911c/apache-kafka.png 1200w","sizes":"(max-width: 800px) 100vw, 800px"}}}}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/confluent-salesforce-connector/","previous":null,"next":{"fields":{"slug":"/working-with-cassandra/"},"frontmatter":{"author":"abhi","tags":["cassandra","performance","nosql","kubernetes"],"title":"Working with cassandra at scale"}}}}}